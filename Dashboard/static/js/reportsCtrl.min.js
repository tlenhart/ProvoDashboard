var app=angular.module("graphapp",["chart.js","ui.bootstrap"]);app.controller("BaseGraphController",function($scope){$scope.category="";$scope.limit=0;$scope.dataCollection={};$scope.loadData=function(pageCategory){$scope.category=pageCategory;$scope.dataCollection=Object.create(graphData.prototype);$scope.dataCollection.load($scope.category,$scope.limit,function(){$scope.$apply()})}});app.controller("GraphController",function($scope,$modal){$scope.loaded=false;$scope.title="";$scope.description="";$scope.labels=[];$scope.series=["2014"];$scope.data=[];$scope.values=[];$scope.type="";$scope.options={};$scope.colours=Chart.defaults.global.colours;$scope.open=function(size){var modalInstance=$modal.open({templateUrl:"modalContent.html",controller:"ModalInstanceCtrl",size:size,resolve:{data:function(){return $scope.data},labels:function(){return $scope.labels},series:function(){return $scope.series},category:function(){return $scope.category},type:function(){return $scope.type},title:function(){return $scope.title},description:function(){return $scope.description}}});modalInstance.result.then(function(){})};$scope.init=function(data){$scope.title=data.title;$scope.description=data.description;$scope.category=data.category;$scope.chartType=data.chartType;data.dataPoints.forEach(function(datum){$scope.labels.push(datum.month);$scope.values.push(datum.value)});$scope.charts=["Line","Bar","Radar","Doughnut","Pie","PolarArea","Base"];if($scope.chartType==="chart-line"){$scope.type="Line";$scope.data[0]=$scope.values}else if($scope.chartType==="chart-bar"){$scope.type="Bar";$scope.data[0]=$scope.values}else if($scope.chartType==="chart-doughnut"){$scope.type="Doughnut";$scope.data=$scope.values}else if($scope.chartType==="chart-pie"){$scope.type="Pie";$scope.data=$scope.values}else if($scope.chartType==="chart-polar"){$scope.type="PolarArea";$scope.data=$scope.values}else if($scope.chartType==="chart-radar"){$scope.type="Radar";$scope.data[0]=$scope.values}else{index=Math.floor(Math.random()*3);$scope.type=$scope.charts[index];$scope.data[0]=$scope.values;console.log("Invalid chart type"+$scope.chartType)}$(".loadergif").hide()}});app.controller("ModalInstanceCtrl",function($scope,$modalInstance,data,labels,series,type,title,description){Chart.defaults.global.animation=true;$scope.dataCollection={};$scope.data=data;$scope.labels=labels;$scope.series=series;$scope.type=type;$scope.title=title;$scope.description=description;$scope.$apply();$scope.requestData=function(){$scope.dataCollection=Object.create(detailedGraphData.prototype);$scope.dataCollection.load($scope.category,$scope.limit,function(){})};$scope.ok=function(){$modalInstance.close()};$scope.close=function(){$modalInstance.close()};$scope.cancel=function(){$modalInstance.dismiss("cancel")}});