var app=angular.module("graphapp",["chart.js","ui.bootstrap"]);app.controller("BaseGraphController",function($scope){$scope.category="",$scope.limit=0,$scope.dataCollection={},$scope.loadData=function(pageCategory){$scope.category=pageCategory,$scope.dataCollection=Object.create(graphData.prototype),$scope.dataCollection.load($scope.category,$scope.limit,function(){$scope.$apply()})}}),app.controller("GraphController",function($scope,$modal){$scope.loaded=!1,$scope.title="",$scope.description="",$scope.labels=[],$scope.series=["2014"],$scope.data=[],$scope.values=[],$scope.allLabels=[],$scope.allValues=[],$scope.type="",$scope.options={},$scope.colours=Chart.defaults.global.colours,$scope.moredata=[],$scope.open=function(size){var modalInstance=$modal.open({templateUrl:"modalContent.html",controller:"ModalInstanceCtrl",size:size,resolve:{data:function(){var tempData=[];return"chart-line"===$scope.chartType||"chart-bar"===$scope.chartType||"chart-radar"===$scope.chartType?tempData[0]=$scope.allValues:tempData=$scope.allValues,tempData},labels:function(){return $scope.allLabels},series:function(){return $scope.series},category:function(){return $scope.category},type:function(){return $scope.type},title:function(){return $scope.title},description:function(){return $scope.description}}});modalInstance.opened.then(function(){}),modalInstance.result.then(function(){})},$scope.init=function(data){$scope.title=data.title,$scope.description=data.description,$scope.category=data.category,$scope.chartType=data.chartType,data.dataPoints.forEach(function(datum){$scope.allLabels.push(datum.month.slice(0,3)+" "+datum.year),$scope.allValues.push(datum.value)}),$scope.allLabels.length<=12?($scope.labels=$scope.allLabels,$scope.values=$scope.allValues):($scope.labels=$scope.allLabels.slice($scope.allLabels.length-12,$scope.allLabels.length),$scope.values=$scope.allValues.slice($scope.allValues.length-12,$scope.allValues.length)),"chart-line"===$scope.chartType?($scope.type="Line",$scope.data[0]=$scope.values):"chart-bar"===$scope.chartType?($scope.type="Bar",$scope.data[0]=$scope.values):"chart-doughnut"===$scope.chartType?($scope.type="Doughnut",$scope.data=$scope.values):"chart-pie"===$scope.chartType?($scope.type="Pie",$scope.data=$scope.values):"chart-polar"===$scope.chartType?($scope.type="PolarArea",$scope.data=$scope.values):"chart-radar"===$scope.chartType?($scope.type="Radar",$scope.data[0]=$scope.values):console.log("Invalid chart type"+$scope.chartType),$(".loadergif").hide()}}),app.controller("ModalInstanceCtrl",function($scope,$modalInstance,data,labels,series,type,title,description){Chart.defaults.global.animation=!0,$scope.dataCollection={},$scope.data=data,$scope.labels=labels,$scope.series=series,$scope.type=type,$scope.title=title,$scope.description=description,$scope.ok=function(){$modalInstance.close()},$scope.close=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}});